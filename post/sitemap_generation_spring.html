<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Sitemap generation with Spring</title>
      <meta charset="utf-8">
      <meta name="viewport" content="initial-scale=1">
      <link rel="stylesheet" href="/css/style.css">
    </head>
    <body>
        <div>
        <strong>
        <a href="/micro/micro-index.html" onClick="this.href+='?rnd='+new Date().getTime()">Micro</a> &middot; 
        <a href="/post/index.html" onClick="this.href+='?rnd='+new Date().getTime()">Macro</a> &middot; 
        <a href="/post/about.html">About</a> &middot; 
        <a href="/post/now.html">Now</a> &middot; 
        <a href="/post/fn.html">fn</a>
        &middot;
        <a href="/twtxt.txt">twtxt</a>
        </strong>
        </div>
        <hr />
        <div id="main">
        <h1 id="title">Sitemap generation with Spring</h1>
        <div id="date"><em>created 2014-10-07 </em></div>
        <div class="content">
        <p>The <code>sitemap.xml</code> file defines all the url that a search engine should crawl on your site and is vital to SEO. After some research on how people did this using Spring mvc, I was quite baffled to see that no one actually used freemarker (or any other template engine) to achieve this and chose the path of cumbersome path of XML marshaling and programming. So I thought I'd write a short tutorial on how to accomplish this task really fast and clean. I'm going to assume that you have spring mvc and freemarker already configured and running, if you don't there are plenty of resources showing how to do that so just go ahead and use them, there is no need to repeat that stuff here. I'll also assume that your freemarker configuration bean <code>org.springframework.web.servlet.view.freemarker.FreeMarkerConfigurer</code> is called <code>freemarkerConfig</code>.</p>
<p>So what we need to do is this</p>
<p>in your controller create a request mapping that maps to <code>/sitemap.xml</code> and produces xml
in this controller get all the urls that youâ€™ll be using and put them in a model
get the <code>sitemap.xml</code> template from freemarker and interpolate this template with the above model.
simple. Here's the code to accomplish this:</p>
<pre><code class="language-java">@Controller
  public class Controller {
    @Resource
    private FreeMarkerConfigurer freemarkerConfigurer;
    @RequestMapping(value = &quot;/sitemap.xml&quot;, produces=&quot;application/xml&quot;)
    @ResponseBody
    public String sitemap() {
       Template template = freemarkerConfigurer.getConfiguration().getTemplate(&quot;sitemap.ftl&quot;);
       Map&amp;lt;String, Object&amp;gt; model = new HashMap&amp;lt;String, Object&amp;gt;();
       List&amp;lt;Product&amp;gt; products = productService.findAll();
       model.put(&quot;products&quot;, products);
       String rendered = FreeMarkerTemplateUtils.processTemplateIntoString(template, model);
       return rendered;
   }
 }
</code></pre>
<p>and the template should look something like this</p>
<pre><code>  [#ftl]
   &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
   &lt;urlset xmlns=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;&gt;
   [#list products as product]
   &lt;url&gt;
      &lt;loc&gt;/${product.sku}/${product.slug}&lt;/loc&gt;
   &lt;/url&gt;
   [/#list]
   &lt;/urlset&gt;

</code></pre>
<pre><code>
</code></pre>

        </div>
        </div>
	<footer>
	<em>generated on 2022-01-18 00:06:40</em>
	</footer>
  Want to say something? Please <a href="mailto:deniz.dizmzn@gmail.com?subject=Sitemap generation with Spring">send</a> an email and I will update this post with our correspondance.
    </body>
</html>
