<html lang="en">
    <head>
      <title>Deniz's personal pages</title>
      <meta charset="utf-8">
      <meta name="viewport" content="initial-scale=1">
      <link rel="stylesheet" href="/css/style.css" />
      <!--script src="/js/vendor/es5-shim.min.js"></script>
      <script src="/js/vendor/ansi_up.min.js"></script>
      <script src="/js/vendor/prism.min.js"></script>
      <script src="/js/vendor/katex.min.js"></script>
      <script src="/js/vendor/katex-auto-render.min.js"></script>
      <link rel="stylesheet" href="/css/vendor/katex.min.css" />
      <link href="https://fonts.googleapis.com/css?family=Roboto:ital,wght@0,300;0,400;0,500;0,700;0,900;1,300;1,400;1,500;1,700;1,900|Roboto+Mono:300,300i,400,400i,500,500i,700,700i&amp;display=swap" rel="stylesheet"-->
    </head>
    <body>
        <div>
        <a href="/micro/micro-index.html" onClick="this.href+='?rnd='+new Date().getTime()">Micro</a> | 
        <a href="/post/index.html" onClick="this.href+='?rnd='+new Date().getTime()">Macro</a> | 
        <a href="/post/about.html">About</a>
        </div>
        <hr />
        <div id="main">
        <h1 id="title"> Kogmind Devlog #4</h1>
        <div id="date"><em> 2020-06-15</em></div>
        <div class="content">
        <p>I was using a fixed seed during the development up until now for the RNG but I thought it would be a good time to start seeing how different seeds affect level generation and weapon rolls. So I started randomizing the seed for the RNG but I also log the selected seed in case I need to reproduce something.</p>
<p>Yesterday I wrote about the ranged targeting line running through walls. It was replacing the wall tiles completely and looked a bit weird so I decided to use the overlay rendering layer to render the targeting line. I also changed the background to green with some transparency so that the wall tiles can be seen. This makes for a better visual.</p>
<p><img src="/img/km20200615.png" alt="" /></p>
<p>With the panning implementation the viewport updates needed to be changed and this has caused some new issues that I discovered today. When the player was alternating directions per turn (left, right, left, right,..) the viewport would update before the level rendered and produced a perception of sluggish rendering. I moved the viewport update to happen after the level rendered in the scheduler tick.</p>
<p><img src="/img/km7.gif" alt="" /></p>
<p>Another annoying bug I introduced by trying to be clever and not rendering cells that are not in FoW caused some quirks. Pay attention to the corridor on the middle left (the last one before the void). As the player moves down it looks like itâ€™s replicating itself to become a thick wall.</p>
<pre><code> if skipFow {

     target[y][x].illumination = illumination

 } else {

     if game.level.fog[y + viewPort.y][x + viewPort.x]  {

         target[y][x].illumination = illumination

     } else {

         //return //this is wrong and causes tiles to hang around

         target[y][x].illumination = 0 //this is correct

     }

 }
</code></pre>
<p><img src="/img/km8.gif" alt="" /></p>
<p>It took quite a while until I understood what was causing the issue as I was thinking that some how a viewport update was getting out of sync with a render call.</p>

        </div>
        </div>
    </body>
</html>
