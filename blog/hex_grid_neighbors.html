<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Deniz's personal pages</title>
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1">
        <script src="/js/vendor/es5-shim.min.js"></script>
        <script src="/js/vendor/marked.min.js"></script>
        <!--script src="/js/vendor/purify.min.js"></script-->
        <script src="/js/vendor/ansi_up.min.js"></script>
        <script src="/js/vendor/prism.min.js"></script>
        <script src="/js/vendor/katex.min.js"></script>
        <script src="/js/vendor/katex-auto-render.min.js"></script>
	<script src="/js/vendor/notebook.js?_=2021-07-12 23:53:08"></script>
        <link rel="stylesheet" href="/css/vendor/katex.min.css" />
        <link rel="stylesheet" href="/css/vendor/prism.css" />
	<link rel="stylesheet" href="/css/notebook.css?2021-07-12 23:53:08" />
	<link rel="stylesheet" href="/css/nbpreview.css?2021-07-12 23:53:08" />
  <link href="https://fonts.googleapis.com/css?family=Roboto:ital,wght@0,300;0,400;0,500;0,700;0,900;1,300;1,400;1,500;1,700;1,900|Roboto+Mono:300,300i,400,400i,500,500i,700,700i&amp;display=swap" rel="stylesheet">
        <script type="application/text" id="source">
          {"cells": [{"cell_type": "markdown", "metadata": {}, "source": ["# hex grid neighbors\n", "", "2017-12-14t00:00:00-07:00 [#gamedev](/tag/gamedev.html) [#hexarategy](/tag/hexarategy.html)\n"]}, {"cell_type": "markdown", "metadata": {"tags": ["gamedev", "hexarategy"]}, "source": ["\n", "In the graph based storage of hex grids an important function for the cells is for them to keep track of their neighbor cells.\n", "\n", "One way you can build the neighbors list is as you are constructing the grid itself. This can be done on a direction basis. Each cell has the following the directions:\n", "\n", "1. NW (northwest)\n", "1. NE (northeast)\n", "1. E (east)\n", "1. SE (southeast)\n", "1. SW (southwest)\n", "1. W (west)\n", "\n", "\n", "We will use an array of size 6 in each cell to store the neighbors. Each position in the array will correspond to a direction. It doesn\u2019t really matter which index is which position as long as your are consistent about it. If you use an enumeration structure you will automatically assign integers for each direction, which you can then use as the indices for the neighbors array. Keep in mid that not every cell has exactly 6 surrounding cells. Depending on the position on the board some cells may have 3 or 5 but never more than 6. Here is an example to clarify things:\n", "\n", "Let\u2019s assume the following values for the 6 directions:\n", "\n", "NW = 0, NE = 1, E = 2, SE = 3, SW = 4, W = 5\n", "\n", "And the Cell object will have a structure similar to `Cell[] neighbors = new Cell[6];`\n", "\n", "if the cell we are looking at has a neighbor on the NW side, then neighbors[0] \n", "will point to the neighbor cell. Incidentally the neighboring cells neighbors \n", "array would have the original cell at the SE (3) position. So this relation \n", "holds:\n", "\n", "For cells with 6 neighbors the original cell is refers to it\u2019s neighbors in a \n", "direction and the neighbors refer to the original cell in the opposite direction.\n", "\n", "How can we calculate the opposite direction? Quite easy: The position you \n", "want + 3 modulo 6. The module will make the directions wrap around after \n", "reaching the end of the direction array.\n", "\n", "Ok so let\u2019s start of with the easiest direction: the W \u2013 E connection.\n", "\n", "![](/img/hgn1.png)\n", "\n", "In this diagram the white arrows show the W-E relationship between cells. \n", "Remember that we are populating the neighbor list as we create the grid, so the \n", "neighboring cells must exist before we can add their pointers to the neighbor \n", "list. If we start from the bottom left corner, the first cell has no neighbors \n", "to the W, so we can skip that. On to the second cell to its right. This guy has\n", "a neighbor to the west so we can add this to the list, and the opposite neighbor \n", "relation also holds. We can do this for the rest of this row, and go on to the \n", "next row. On the next row, the same is true: skip the first add the rest. So the\n", "condition for creating the E/W relation can be written\n", "\n", "```\n", "function addCell(x,z,i) {\n", " \n", " if (x > 0)\n", " {\n", "  cell.neighbors[W] = cells[i - 1];\n", "  cells[i-1].neighbors[W + 3 % 6] = cell;\n", " }\n", " \n", "}\n", "```\n", "\n", "The assumption here is that all the cells in the grid are stored in an array called cells. This is a 1 dimensional array. I felt that this may be a bit counter intuitive and deserved a remark. The function will be called for each X, Z coordinate with the position of the cell in the cells array.\n", "\n", "For the SW and SE relations we need to distinguish between the cases of even and odd rows. Why? because the the first and last hex of the rows change which neighbors they have. The first element of the 2. row (index 1 so odd) has a SW and SE neighbor but the last hex is missing a SE neighbor. The first element of the 3rd row (index 2) is missing the SW neighbor. None of the cells on the first row have a SE or SW neighbor. So our conditions are:\n", "\n", "```\n", "if (z > 0 ) {\n", " if (z % 2 == 0) {\n", "  ...\n", " } else {\n", "  ...\n", " }\n", "}\n", "```\n", "\n", "Let\u2019s take a look at the even case, the purple and orange arrows:\n", "\n", "The first cell doesn\u2019t have a SW neighbor, so that\u2019s will be a special case. The rest of the cells have both neighbors.\n", "\n", "```\n", "if (z % 2 ==0) {\n", " cell.neighbors[SE] = cells[i - width]\n", " //add the opposite too\n", " if (x > 0) {\n", "  cell.neighbors[SW] = cells[i - width - 1] \n", "  //add the opposite too\n", " }\n", "}\n", "\n", "//The odd case (yellow and green arrows):\n", "\n", "if (z % 2 == 0) {\n", "...\n", "} else {\n", " cell.neighbors[SW] = cells[i - width]\n", " //add the opposite\n", " if (x < width - 1) {\n", "  cell.neighbors[SE] = cells[i-width+1]\n", "  //add the opposite\n", " }\n", "}\n", "```\n"]}], "metadata": {"celltoolbar": "Tags", "kernelspec": {"display_name": "Python 3", "language": "python", "name": "python3"}, "language_info": {"codemirror_mode": {"name": "ipython", "version": 3}, "file_extension": ".py", "mimetype": "text/x-python", "name": "python", "nbconvert_exporter": "python", "pygments_lexer": "ipython3", "version": "3.6.12"}}, "nbformat": 4, "nbformat_minor": 4}
        </script>
    </head>
    <body>
        <div id="main">
            <div class="header">
            <div style="position: absolute; left:10px; top:5px;">
              <a href="/blog/about.html">about</a>
              <!--a href="/micro/micro.html">micro</a-->
              <a href="/blogindex.html">index</a>
            </div>
            <h1>Deniz's Weblog</h1>
            <p style="font-family: monospace;">
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
            </p>
            </div>
            <div id="notebook-holder"></div>
            <hr/>
            <div>
              <em>Generated on 2021-07-12 23:53:08</em>
            </div>
            <p>
              Questions or comments? Please take the time to compose an email and send it to <a href="mailto:deniz.dizman@gmail.com?subject=Question/Comment">me</a>.
              I will update the relevant page with our correspondence.
            </p>
        </div>
        <script>
          var src = document.getElementById("source");
          var notebook = nb.parse(JSON.parse(src.innerText));
          var rendered = notebook.render();
          document.getElementById("notebook-holder").appendChild(rendered);
        </script>
    </body>
</html>
