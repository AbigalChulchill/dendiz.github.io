<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Deniz's personal pages</title>
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1">
        <script src="/js/vendor/es5-shim.min.js"></script>
        <script src="/js/vendor/marked.min.js"></script>
        <!--script src="/js/vendor/purify.min.js"></script-->
        <script src="/js/vendor/ansi_up.min.js"></script>
        <script src="/js/vendor/prism.min.js"></script>
        <script src="/js/vendor/katex.min.js"></script>
        <script src="/js/vendor/katex-auto-render.min.js"></script>
	<script src="/js/vendor/notebook.js?_=2021-09-02 13:50:11"></script>
        <link rel="stylesheet" href="/css/vendor/katex.min.css" />
        <link rel="stylesheet" href="/css/vendor/prism.css" />
	<link rel="stylesheet" href="/css/notebook.css?2021-09-02 13:50:11" />
	<link rel="stylesheet" href="/css/nbpreview.css?2021-09-02 13:50:11" />
  <link href="https://fonts.googleapis.com/css?family=Roboto:ital,wght@0,300;0,400;0,500;0,700;0,900;1,300;1,400;1,500;1,700;1,900|Roboto+Mono:300,300i,400,400i,500,500i,700,700i&amp;display=swap" rel="stylesheet">
        <script type="application/text" id="source">
          {"cells": [{"cell_type": "markdown", "id": "9fe9c526", "metadata": {}, "source": ["# jupyter notebook custom magic\n", "", "2021-09-01 [#programming](/tag/programming.html)\n"]}, {"cell_type": "markdown", "id": "f4122619", "metadata": {}, "source": ["Jupyter notebooks a great way of prototyping small programs and exploring/visualizing data from scripts. I use them to run back tests on trading algos. One of the most power features is that you can actually pipe the contents of a cell to another python function. This feature came in really handy when I wanted to pipe a trading algo into my backtesting framework. To accomplish this you need to make use of \"magics\"\n", "\n", "First create a function in your `__init__.py` file in your package\n", "\n", "```\n", "def load_ipython_extension(ipython):\n", "        def rtrade(line, cell):\n", "            parser = argparse.ArgumentParser()\n", "            parser.add_argument(\"-s\", help=\"start date YYYY-mm-dd\", dest=\"start\",\n", "                    action=\"store\", required=False)\n", "            parser.add_argument(\"-e\", help=\"end date YYYY-mm-dd\", dest=\"end\",\n", "                    action='store', required=False)\n", "            parser.add_argument(\"-o\", help=\"result output file name\", dest=\"output\",\n", "                    action='store', required=False, default=\"result_df.pickle\")\n", "            # We create a string buffer containing the\n", "            # contents of the cell.\n", "            args = parser.parse_args(line.split())\n", "            sio = StringIO(cell)\n", "            print(\"dates\",args.start)\n", "            print(\"end\", args.end)\n", "            return Simulator(args.start, args.end, args.output).test(cell)\n", "        ipython.register_magic_function(rtrade, \"line_cell\", \"rtrade\")\n", "```\n", "\n", "when we load the extension Jupyter will execute this function for us. The line parameter is the line of the magic function and the cell parameter is the contents of the cell.\n", "\n", "Load the extension with (my package is called retrotrade)\n", "\n", "```\n", "%load_ext retrotrade\n", "```\n", "\n", "now execute the magic with\n", "\n", "\n", "```\n", "%%rtrade -s 2020-01-01 -e 2021-01-01 -o result.pickle\n", "\n", "<some python code>\n", "```\n", "\n", "The line parameter above will contain the first line that starts with `%%` and the cell parameter will contain the rest of the cell contents. "]}], "metadata": {"celltoolbar": "Tags", "kernelspec": {"display_name": "Python 3 (ipykernel)", "language": "python", "name": "python3"}, "language_info": {"codemirror_mode": {"name": "ipython", "version": 3}, "file_extension": ".py", "mimetype": "text/x-python", "name": "python", "nbconvert_exporter": "python", "pygments_lexer": "ipython3", "version": "3.9.6"}}, "nbformat": 4, "nbformat_minor": 5}
        </script>
    </head>
    <body>
        <div id="main">
            <div class="header">
            <div style="position: absolute; left:10px; top:5px;">
              <a href="/blog/about.html?2021-09-02 13:50:11">about</a>
              <a href="/micro/micro.html?2021-09-02 13:50:11">micro</a>
              <a href="/blogindex.html?2021-09-02 13:50:11">macro</a>
            </div>
            <h1>Deniz's Weblog</h1>
            <p style="font-family: monospace;">
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
            </p>
            </div>
            <div id="notebook-holder"></div>
            <hr/>
            <div>
              <em>Generated on 2021-09-02 13:50:11</em>
            </div>
            <p>
              Questions or comments? Please take the time to compose an email and send it to <a href="mailto:deniz.dizman@gmail.com?subject=Question/Comment">me</a>.
              I will update the relevant page with our correspondence.
            </p>
        </div>
        <script>
          var src = document.getElementById("source");
          var notebook = nb.parse(JSON.parse(src.innerText));
          var rendered = notebook.render();
          document.getElementById("notebook-holder").appendChild(rendered);
        </script>
    </body>
</html>
