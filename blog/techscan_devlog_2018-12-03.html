<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Deniz's personal pages</title>
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1">
        <script src="/js/vendor/es5-shim.min.js"></script>
        <script src="/js/vendor/marked.min.js"></script>
        <!--script src="/js/vendor/purify.min.js"></script-->
        <script src="/js/vendor/ansi_up.min.js"></script>
        <script src="/js/vendor/prism.min.js"></script>
        <script src="/js/vendor/katex.min.js"></script>
        <script src="/js/vendor/katex-auto-render.min.js"></script>
	<script src="/js/vendor/notebook.js?_=2021-07-20 20:23:00"></script>
        <link rel="stylesheet" href="/css/vendor/katex.min.css" />
        <link rel="stylesheet" href="/css/vendor/prism.css" />
	<link rel="stylesheet" href="/css/notebook.css?2021-07-20 20:23:00" />
	<link rel="stylesheet" href="/css/nbpreview.css?2021-07-20 20:23:00" />
  <link href="https://fonts.googleapis.com/css?family=Roboto:ital,wght@0,300;0,400;0,500;0,700;0,900;1,300;1,400;1,500;1,700;1,900|Roboto+Mono:300,300i,400,400i,500,500i,700,700i&amp;display=swap" rel="stylesheet">
        <script type="application/text" id="source">
          {"cells": [{"cell_type": "markdown", "metadata": {}, "source": ["# techscan devlog 2018-12-03\n", "", "2018-12-03 [#techscan](/tag/techscan.html) [#fintech](/tag/fintech.html) [#devlog](/tag/devlog.html)\n"]}, {"cell_type": "markdown", "metadata": {"tags": ["techscan", "fintech", "devlog"]}, "source": ["\n", "A new month a new dev log for the stuff that\u2019s been going on\n", "\n", "Huge change yet again for the engine which I will get into later. First order\n", "of business is a summary of the new stuff:\n", "\n", "## Summary\n", "\n", "1. get rid of all but USD pairings for cryptos\n", "2. reduce symbol listing response size from 1.2M to 0.8M\n", "3. new scanner: trend start\n", "4. S/R zones to charts\n", "5. using TaLib java API\n", "6. Candle stick patterns scanners\n", "7. port back over to java w/o spring + hibernate\n", "8. eclim, idea + X forward, Che adventures\n", "9. market overview calculations in SQL\n", "10. store technical calculations in KV store\n", "11. correlation calculations in technical calculations\n", "\n", "## Good bye pairings\n", "\n", "Some of the alt coins are worth so less that compared with BTC they end up\n", "taking 8-9 decimal places. This is a disaster for the display and the layout of\n", "the app in general. At first I had thought about displaying these types of\n", "currency pairs as satoshis but that was met with high resistance from my\n", "previous team members. The pair name is XXX/BTC so you cannot display it in\n", "Satoshi\u2019s was the justification. Fair enough I guess. Another fix for this\n", "could be decreasing the font size if there are a lot of decimal places, but I\n", "have tried this. It sounds like it should work in theory but I\u2019d have to\n", "experiment with it to be convinced that it does. So for the time being the\n", "easiest solution is to drop pairings with BTC and keep only the pairs that are\n", "traded against the USD. All of the big coins are included in this so no big\n", "loss their.\n", "\n", "## Slim responses\n", "\n", "The autocomplete component of Vuetify requires a list of the items to complete\n", "(though I\u2019m pretty sure their should be a version that can do partial searches\n", "with AJAX) and that list in the previous version was huge around 1.2 megabytes.\n", "The initial delay after the autocomplete trigger was around 2 seconds which\n", "made it appear to be not responding. My primary solution to this was to trigger\n", "a request to the symbol listing endpoint after the app loaded in the background\n", "and since requests are cached the searches would not have that initial lag.\n", "This worked out like I thought but the payload size is still more than I cared\n", "for so I got rid of some of the fields in the response and change the structure\n", "from a JSON object to an array dropping the keys and therefore reducing the\n", "size even further.\n", "\n", "## More scanners\n", "\n", "A saw a scanner on STB that I wanted to incorporate as I think it\u2019s important:\n", "The new trend started scanner. It fires when the ADX crosses the 25 line. Even\n", "though ADX lags it\u2019s still useful to know that a trend has begun.\n", "\n", "## More charts\n", "\n", "Data visualizations are always cool, you can never get enough of them. This\n", "motivated me to add a chart displaying the support and resistance zones\n", "calculated using the clustering method I blogged about a couple of weeks back.\n", "\n", "![](/img/ts2.png)\n", "\n", "I plan on adding charts to each triggered scan with the relevant indicators\n", "like MA\u2019s for MA crossovers etc. But it\u2019s a low priority task right now.\n", "\n", "## New technical analysis library\n", "\n", "Ta-lib.org is a mature technical analysis library that supports way more\n", "indicators that I built into talib4j. I was quite happy with the results I got\n", "when\n", "\n", "using the python wrapper so it\u2019s back in. I plan on doing a write up on the\n", "performance vs talib4j as the code is probably transpiled from the C version\n", "and impossible to read. The Java API is god awful because of this generated\n", "code, which means the C API is just as disgusting. To limit the exposure to\n", "this filth I wrapper the API with a custom class and I can just substitute that\n", "for talib4j any time if I have all the indicators coded in.\n", "\n", "## Even more scanners\n", "\n", "Using Talib also gives me access to candle pattern recognition. I didn\u2019t want\n", "to write a scanner for each of the patterns so I had to resort to using the\n", "java reflection API to figure out the correct method to call from the scan\n", "definition file. So the definition file is something like this:\n", "\n", "``` { \u201cid\u201d: \u201c\u2026\u201d \u201cname\u201d: \u201csome scanner\u201d: \u201cmodule\u201d: \u201cCDL2CROWS\u201d } ```\n", "\n", "I had all the definitions generated from the documentation on the talib site\n", "with a small python script (around 60 different scans) and look up the method\n", "from the module attribute of the definition. With the addition of all the\n", "candle patterns each run consists now of around 16K scans!\n", "\n", "## Back to the drawing board\n", "\n", "Now that I am running 16K scans the python code took 48 hours to complete a\n", "days worth of scans. This of course is unacceptable as the scans need to be\n", "done quickly. It\u2019s no use to display scans 2 days after the market closes. I\n", "poked around with multi threading in the python code but to no avail as there\n", "is this thing called the \u201cGlobal Interpreter Lock\u201d which limits you to the\n", "total performance of a single core. Also using multi threaded code consume too\n", "much memory \u2013 something which I will not have that much of in production. So\n", "back to a faster language: Java. But this time I didn\u2019t want all the bloat that\n", "comes with spring + hibernate. They consume way too much memory that was one of\n", "the reasons for going with python. So this time around it\u2019s a plain old Java\n", "application with small utility libraries for database operations. Now 16K scans\n", "take 1 hour to complete without multi threaded code. I was initially thinking\n", "of keeping the python engine for other stuff like synchronization, and\n", "technical calculations etc. but ended up porting all the engine code back to\n", "Java.\n", "\n", "## Have Chromebook will code\n", "\n", "I got a new toy from the Black Friday sales events so naturally I want to use\n", "it all the time. But it\u2019s not buffed in terms of hardware so I needed to find a\n", "way of coding Java without running a full blown IDE on my Chromebook. It would\n", "probably run the IDE OK but the engine + database would put to much strain and\n", "it would start to crawl. So I started coding in Emacs. Plain old Emacs with no\n", "packages. It sounds crazy and it actually is quite crazy. It was nice just\n", "suspending the machine and reattaching the session to continue where I left\n", "off, but no syntax checking, not auto imports makes it a hassle. Not being able\n", "to see the parameters of a method call was the worst. So I checked out what\n", "packages people were using for coding on Emacs. The most effective one seemed\n", "to be Eclim. I had used Eclim before with vim (which is the original purpose of\n", "Eclim: Eclipse + vim) but somebody had wrote a wrapper around the binary for\n", "Emacs. I tried to get it running on my Debian development server but I could\n", "not get it to work. It would just not connect. So I gave up on Eclim and\n", "checked out another package called Megahanada. Found that one too complicated\n", "and didn\u2019t really find the functions it provided useful. Then I tried X\n", "forwarding with Intellij Idea. This felt like home a familiarity that was much\n", "appreciated. This lasted for a week or 2 until the inefficient X protocol drove\n", "me nuts with the stupid lagging of the UI. I looked around for some\n", "alternatives and came across xpra which was supposed to be faster but really\n", "wasn\u2019t. And the fonts and graphics were blurry with Xpra so it went out the\n", "window. I thought that maybe it was Swing that wasn\u2019t playing nicely so I tried\n", "X forwarding with VS Code. Same problems. But on a side note I really liked the\n", "Java plugin for VS Code \u2013 it\u2019s lightweight and provides all the great\n", "functionality that I was searching for. Anyways then I remembered Eclipse Che \u2013\n", "A web based IDE. I had tried Che before in it\u2019s early stages and wasn\u2019t really\n", "impressed with it\u2019s current state. But know they\u2019ve created a Docker image\n", "which is super easy to install and get running and they\u2019ve also added Git\n", "support so worst I could use Che to write the code push and compile/test on my\n", "development server. But Che workspaces already come with Java + Maven so I\n", "could basically do everything I wanted in the Che environment. Another bad\n", "thing with X Forwarding was that once the laptop suspended the SSH connection\n", "was lost and the applications died on me. Since I have leave the computer to do\n", "other stuff (like burping, diaper changes, etc) this was bugging me quite a\n", "bit. Now in Che the tab remains open and I can continue where I left off\n", "without a problem.\n", "\n", "## Bugs bugs bugs\n", "\n", "Porting over code is also a great chance to check what I\u2019ve actually written. I\n", "figured out major bugs in the technical calculations code which I fixed. I was\n", "doing all of these calculations in application code, which is probably slower\n", "than doing them on the DB side so I moved the things I could calculate on the\n", "DB over there.\n", "\n", "## few architectural changes\n", "\n", "I was letting the API calculate some of the data on the symbol detail view on\n", "the fly, but now I decided to have these pre-calculated for the last trade date\n", "and store them in the key/value store. I really wan\u2019t refrain from having the\n", "API do calculations to consolidate all the logic on the engine code base. This\n", "meant moving the technical and overview tab data to the key/value store. I also\n", "wanted to merge these to requests as they did have a couple of overlapping\n", "values. I also decided to store the correlation data in the key/value store as\n", "it was taking up a lot of rows in the table. I was keeping a history of the\n", "correlated items which is probably not necessary. While at it I also removed\n", "the dedicated job for correlated calculations and merged it into the technical\n", "calculations.\n", "\n", "Wow that was quite a long post \u2013 a lot has happened in the past week.\n"]}], "metadata": {"celltoolbar": "Tags", "kernelspec": {"display_name": "Python 3", "language": "python", "name": "python3"}, "language_info": {"codemirror_mode": {"name": "ipython", "version": 3}, "file_extension": ".py", "mimetype": "text/x-python", "name": "python", "nbconvert_exporter": "python", "pygments_lexer": "ipython3", "version": "3.6.13"}}, "nbformat": 4, "nbformat_minor": 4}
        </script>
    </head>
    <body>
        <div id="main">
            <div class="header">
            <div style="position: absolute; left:10px; top:5px;">
              <a href="/blog/about.html">about</a>
              <!--a href="/micro/micro.html">micro</a-->
              <a href="/blogindex.html">micro</a>
            </div>
            <h1>Deniz's Webblog</h1>
            <p style="font-family: monospace;">
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
            </p>
            </div>
            <div id="notebook-holder"></div>
            <hr/>
            <div>
              <em>Generated on 2021-07-20 20:23:00</em>
            </div>
            <p>
              Questions or comments? Please take the time to compose an email and send it to <a href="mailto:deniz.dizman@gmail.com?subject=Question/Comment">me</a>.
              I will update the relevant page with our correspondence.
            </p>
        </div>
        <script>
          var src = document.getElementById("source");
          var notebook = nb.parse(JSON.parse(src.innerText));
          var rendered = notebook.render();
          document.getElementById("notebook-holder").appendChild(rendered);
        </script>
    </body>
</html>
