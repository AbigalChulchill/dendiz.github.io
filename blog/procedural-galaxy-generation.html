<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Deniz's personal pages</title>
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1">
        <script src="/js/vendor/es5-shim.min.js"></script>
        <script src="/js/vendor/marked.min.js"></script>
        <!--script src="/js/vendor/purify.min.js"></script-->
        <script src="/js/vendor/ansi_up.min.js"></script>
        <script src="/js/vendor/prism.min.js"></script>
        <script src="/js/vendor/katex.min.js"></script>
        <script src="/js/vendor/katex-auto-render.min.js"></script>
	<script src="/js/vendor/notebook.js?_=2021-09-09 09:20:10"></script>
        <link rel="stylesheet" href="/css/vendor/katex.min.css" />
        <link rel="stylesheet" href="/css/vendor/prism.css" />
	<link rel="stylesheet" href="/css/notebook.css?2021-09-09 09:20:10" />
	<link rel="stylesheet" href="/css/nbpreview.css?2021-09-09 09:20:10" />
  <link href="https://fonts.googleapis.com/css?family=Roboto:ital,wght@0,300;0,400;0,500;0,700;0,900;1,300;1,400;1,500;1,700;1,900|Roboto+Mono:300,300i,400,400i,500,500i,700,700i&amp;display=swap" rel="stylesheet">
        <script type="application/text" id="source">
          {"cells": [{"cell_type": "markdown", "metadata": {}, "source": ["# galaxy generation algorithm\n", "", "2018-05-09 [#gamedev](/tag/gamedev.html)\n"]}, {"cell_type": "markdown", "metadata": {"tags": ["gamedev"]}, "source": ["\n", "an integral part of a 4x space game is the galaxy generation. Galaxy generation means speading out the stars in your galaxy in a way that looks good,\n", "should resemeble reality and must satisfy some constraints. If you take a look at the maps fom old 4x games you will see that the stars are laid out in a very \n", "linear fashion. The method used here is splitting the coordinate plane into sectors of a defined height/width and then randomly placing stars in side this \n", "satisfying a density constraint. You also have to check the neighboring sectors for stars that are near the border otherwise you might end up with star \n", "that are very close to each other. This is a tedious way of going about things and the end result isn\u2019t that satisfactory.\n", "\n", "Here is an example of the sector method\n", "\n", "![](/img/57c7fdc9d8a3b.png)\n", "\n", "A better method is generating a spiral galaxy. I\u2019ve being doing some research on the subject and there are various methods even some involving actual \n", "astro-physical calculations (simplified) but these are still to complicated and a better approximated result can be obtained will less hassle. \n", "Here is the version that I found which works quite well\n", "\n", "![](/img/57c7fdedc12aa-2.png)\n", "\n", "Each black dot represents a star in the system. I think it looks nice and quasi realistic. The code to accomplish this layout is\n", "\n", "```\n", " public Galaxy generate(Galaxy galaxy) {\n", " \n", "        int NUMHUB = 20;\n", "        int NUMDISK = 5000;\n", "        double DISKRAD = 400;\n", "        double HUBRAD = 50;\n", "        int NUMARMS = 3;\n", "        double ARMROTS = 0.5;\n", "        double ARMWIDTH = 65.0;\n", "        double FUZZ = 25.0;\n", " \n", "        double omega = 360 / NUMARMS;\n", "        int i = 0;\n", "        while (i < NUMDISK) {\n", "            i++;\n", " \n", "            double dist = HUBRAD + RandomUtils.nextFloat(0, 1) * DISKRAD;\n", "            double theta = ((360.0 * ARMROTS * (dist / DISKRAD))) + RandomUtils.nextFloat(0, 1) * ARMWIDTH\n", "                    + omega * RandomUtils.nextInt(0, NUMARMS) + RandomUtils.nextFloat(0, 1) * FUZZ * 2.0 - FUZZ;\n", " \n", "            double x = Math.cos(theta * Math.PI / 180) * dist;\n", "            double y = Math.sin(theta * Math.PI / 180) * dist;\n", " \n", "            Star star = starService.create(x + galaxy.getSize().getWidth() /2 , y + galaxy.getSize().getHeight() / 2);\n", "            if (!isDensitySatisfied(galaxy, star)) { //make sure that the stars are not too close to eachother\n", "                LOGGER.info(\"density condition failed.\");\n", "                continue;\n", "            }\n", "            galaxy.getStars().add(star);\n", "        }\n", " \n", "        i = 0;\n", "        while (i < NUMHUB) {\n", "            i++;\n", " \n", "            double dist = RandomUtils.nextFloat(0, 1) * HUBRAD;\n", "            double theta = RandomUtils.nextFloat(0, 1) * 360;\n", "            double x = Math.cos(theta * Math.PI / 180) * dist;\n", "            double y = Math.sin(theta * Math.PI / 180) * dist;\n", "            Star star = starService.create(x + 500, y + 500);\n", "            if (!isDensitySatisfied(galaxy, star)) {\n", "                LOGGER.info(\"density condition failed.\");\n", "                continue;\n", "            }\n", " \n", "            galaxy.getStars().add(star);\n", "        }\n", " \n", "        return galaxy;\n", " \n", "    }\n", "```\n", "\n", "Here is a legend of what the knobs in the code actually tweak\n", "\n", "![](/img/57c7fe1749fc3-2.png)\n", "\n", "\n", "The only gotcha here is that you may not get the number of stars that you requested if the density checking function returns false for some stars. \n", "But thats no big problem as you are requesting a constraint be satisfied.\n", "The algorithm used is by Ben Motz <motzb-at-hotmail.com> The original C source code for DOS (including a 3D viewer).\n"]}], "metadata": {"celltoolbar": "Tags", "kernelspec": {"display_name": "Python 3", "language": "python", "name": "python3"}, "language_info": {"codemirror_mode": {"name": "ipython", "version": 3}, "file_extension": ".py", "mimetype": "text/x-python", "name": "python", "nbconvert_exporter": "python", "pygments_lexer": "ipython3", "version": "3.6.12"}}, "nbformat": 4, "nbformat_minor": 4}
        </script>
    </head>
    <body>
        <div id="main">
            <div class="header">
            <div style="position: absolute; left:10px; top:5px;">
              <a href="/blog/about.html?2021-09-09 09:20:10">about</a>
              <a href="/micro/micro.html?2021-09-09 09:20:10">micro</a>
              <a href="/blogindex.html?2021-09-09 09:20:10">macro</a>
            </div>
            <h1>Deniz's Weblog</h1>
            <p style="font-family: monospace;">
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
                <!-- a class="inverted" href="/tag/.html">/</a-->
            </p>
            </div>
            <div id="notebook-holder"></div>
            <hr/>
            <div>
              <em>Generated on 2021-09-09 09:20:10</em>
            </div>
            <p>
              Questions or comments? Please take the time to compose an email and send it to <a href="mailto:deniz.dizman@gmail.com?subject=Question/Comment">me</a>.
              I will update the relevant page with our correspondence.
            </p>
        </div>
        <script>
          var src = document.getElementById("source");
          var notebook = nb.parse(JSON.parse(src.innerText));
          var rendered = notebook.render();
          document.getElementById("notebook-holder").appendChild(rendered);
        </script>
    </body>
</html>
